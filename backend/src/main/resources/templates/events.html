<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{layout :: layout(~{::main})}">

<body>
    <main>
        <section style="padding: 60px 0;" class="animate-fade">
            <div class="container">
                <div style="display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 2rem;">
                    <div>
                        <h1 style="font-size: 2.5rem; margin-bottom: 0.5rem;">Etkinlikler</h1>
                        <p style="color: #94a3b8;">Ãœniversitendeki en son etkinlikleri takip et.</p>
                    </div>
                    <form action="/events" method="get" style="display: flex; gap: 1rem;">
                        <input type="text" name="search" th:value="${searchQuery}" placeholder="Etkinlik ara..."
                            style="background: var(--glass); border: 1px solid var(--glass-border); padding: 0.6rem 1rem; border-radius: 8px; color: white;">
                        <button type="submit"
                            style="background: var(--primary); color: white; border: none; padding: 0.6rem 1rem; border-radius: 8px; cursor: pointer;">Ara</button>
                        <a th:if="${searchQuery}" href="/events"
                            style="display: flex; align-items: center; justify-content: center; background: rgba(255, 255, 255, 0.1); color: white; border: none; padding: 0.6rem; border-radius: 8px; cursor: pointer; text-decoration: none;">âœ•</a>
                    </form>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 3fr; gap: 2rem; align-items: start;">

                    <!-- Sidebar -->
                    <aside
                        style="background: var(--glass); border: 1px solid var(--glass-border); border-radius: 16px; padding: 1.5rem; position: sticky; top: 100px;">
                        <h3 style="font-size: 1.2rem; margin-bottom: 1rem; color: var(--primary);">Filtreler</h3>

                        <div style="margin-bottom: 2rem;">
                            <h4
                                style="font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px; color: #94a3b8; margin-bottom: 0.8rem;">
                                Durum</h4>
                            <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                                <a href="/events"
                                    th:classappend="${selectedStatus == null or selectedStatus == 'ACTIVE'} ? 'active-filter' : ''"
                                    style="padding: 8px 12px; border-radius: 8px; color: white; text-decoration: none; transition: all 0.2s;"
                                    onmouseover="this.style.background='rgba(255,255,255,0.1)'"
                                    onmouseout="this.style.background='transparent'">
                                    ğŸ“… GÃ¼ncel Etkinlikler
                                </a>
                                <a href="/events?status=PASSIVE"
                                    th:classappend="${selectedStatus == 'PASSIVE'} ? 'active-filter' : ''"
                                    style="padding: 8px 12px; border-radius: 8px; color: white; text-decoration: none; transition: all 0.2s;"
                                    onmouseover="this.style.background='rgba(255,255,255,0.1)'"
                                    onmouseout="this.style.background='transparent'">
                                    ğŸ•°ï¸ GeÃ§miÅŸ Etkinlikler
                                </a>
                            </div>
                        </div>

                        <div>
                            <h4
                                style="font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px; color: #94a3b8; margin-bottom: 0.8rem;">
                                KulÃ¼pler</h4>
                            <div
                                style="display: flex; flex-direction: column; gap: 0.5rem; max-height: 400px; overflow-y: auto;">
                                <a href="/events" th:classappend="${selectedClubId == null} ? 'active-filter' : ''"
                                    style="padding: 8px 12px; border-radius: 8px; color: white; text-decoration: none; transition: all 0.2s;"
                                    onmouseover="this.style.background='rgba(255,255,255,0.1)'"
                                    onmouseout="this.style.background='transparent'">
                                    TÃ¼m KulÃ¼pler
                                </a>
                                <a th:each="club : ${clubs}" th:href="@{/events(clubId=${club.id})}"
                                    th:classappend="${selectedClubId == club.id} ? 'active-filter' : ''"
                                    style="padding: 8px 12px; border-radius: 8px; color: white; text-decoration: none; transition: all 0.2s; display: flex; align-items: center; justify-content: space-between;"
                                    onmouseover="this.style.background='rgba(255,255,255,0.1)'"
                                    onmouseout="this.style.background='transparent'">
                                    <span th:text="${club.name}">KulÃ¼p AdÄ±</span>
                                </a>
                            </div>
                        </div>
                    </aside>

                    <!-- Event Grid -->
                    <div class="event-grid" style="grid-column: auto;">
                        <th:block th:if="${selectedStatus == 'PASSIVE'}">
                            <div
                                style="grid-column: 1/-1; background: rgba(255, 100, 100, 0.1); border: 1px solid rgba(255, 100, 100, 0.3); padding: 1rem; border-radius: 12px; margin-bottom: 1rem; color: #ffcccc;">
                                â„¹ï¸ Åu anda <strong>geÃ§miÅŸ (pasif)</strong> etkinlikleri gÃ¶rÃ¼ntÃ¼lÃ¼yorsunuz.
                            </div>
                        </th:block>

                        <div th:each="ae : ${events}" class="event-card" style="position: relative;">
                            <!-- Passive Badge -->
                            <div th:if="${ae.status == 'PASSIVE'}"
                                style="position: absolute; top: 1rem; right: 1rem; background: #ef4444; color: white; padding: 4px 10px; border-radius: 20px; font-size: 0.75rem; font-weight: bold; z-index: 10;">
                                PASÄ°F
                            </div>

                            <div style="display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 12px;">
                                <span class="event-badge" th:text="${ae.eventType}">Konferans</span>
                                <span th:if="${ae.clubName}" class="event-badge"
                                    style="background: rgba(99, 102, 241, 0.2); color: #6366f1;">
                                    ğŸ›ï¸ <span th:text="${ae.clubName}">KulÃ¼p</span>
                                </span>
                            </div>
                            <h3 th:text="${ae.title}">Etkinlik BaÅŸlÄ±ÄŸÄ±</h3>
                            <p th:text="${ae.description}"
                                style="color: #94a3b8; font-size: 0.875rem; margin-bottom: 1.5rem; display: -webkit-box; -webkit-line-clamp: 2; line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
                                Etkinlik aÃ§Ä±klamasÄ± burada yer alacak ve iki satÄ±rla sÄ±nÄ±rlÄ± kalacaktÄ±r.
                            </p>
                            <div class="event-meta">
                                <span th:text="${ae.eventDate}">12.03.2026</span>
                                <span th:text="${ae.startTime}">14:00</span>
                                <span th:if="${ae.price != null and ae.price > 0}"
                                    style="background: linear-gradient(135deg, #a855f7, #ec4899); padding: 4px 10px; border-radius: 12px; font-weight: 700; font-size: 0.8rem;">
                                    â‚º<span th:text="${#numbers.formatDecimal(ae.price, 1, 2)}">50.00</span>
                                </span>
                                <span th:if="${ae.price == null or ae.price == 0}"
                                    style="background: linear-gradient(135deg, #10b981, #059669); padding: 4px 10px; border-radius: 12px; font-weight: 700; font-size: 0.8rem;">
                                    ÃœCRETSÄ°Z
                                </span>
                            </div>
                            <a th:href="@{/events/{id}(id=${ae.id})}" class="btn"
                                style="width: 100%; margin-top: 1.5rem; text-align: center; border: 1px solid var(--glass-border); display: block;">DetaylarÄ±
                                GÃ¶r</a>
                        </div>

                        <!-- Empty state if no events -->
                        <div th:if="${#lists.isEmpty(events)}"
                            style="grid-column: 1 / -1; text-align: center; padding: 4rem;">
                            <p style="color: #94a3b8;">Bu kriterlere uygun etkinlik bulunmuyor.</p>
                            <a href="/events"
                                style="color: var(--primary); margin-top: 1rem; display: inline-block;">Filtreleri
                                Temizle</a>
                        </div>
                    </div>
                </div>

                <style>
                    .active-filter {
                        background: var(--primary) !important;
                        font-weight: bold;
                    }
                </style>
            </div>
        </section>
    </main>
</body>

</html>